Directed Visual System (DViz)

Release 1.0 Feature Target List
----

Networked Players
Slide Groups
Playlists
Live cameras
Video backgrounds
DVD
Bible text


-----

Revised Task list for Release 1.0, 10/10/09:
	----------------------------
	"Tasty Breakfast" Release
	----------------------------
	Target Use Cases: 
	Songs, Announcements, Sermon
	----------------------------
	
	- Models:
		[DONE] - Song Database Model
			[DONE] - SQLite Backend 
	- Logic:
		[DONE] - Translator/Slide Generator
			[DONE] - Given a Song, translate into a slide group
	- UI:
		- List of forms needed:
			[ALMOST] - "Grid and Guidelines" Form
			- Slide Group settings (aspect ratio, etc)
			[DONE] - Song Editor
		[DONE] - SongDatabase List View
			- One column
			#- Three columns:
			#	- Title, #, Tags (Chorus, Hymn, etc)
		[DONE] - Search Function:
			[NOT IMPL] - Default to Full Text, Sort by Title
				- only implemented title search, but can match any part of title and can use wildcards
			#- Title
			#- Name
			#- Full Text
		[DONE] - Random access viewer control
			[DONE] - Just do it
			[DONE] - Should be "smart" - for songs, render differently than generic slide groups
			[DONE] - Go by Group Type?
		[POSSIBLY LATER] - In-flight edits
			- need to add specific framework for this
	- Visuals:
		[DONE] - Add Aspect Ratio setting
		[DONE] - Text Centering in a Text Box
		[DONE] - Cross Fade on Changing Slide
			[DONE] - Important Point:
				[DONE] - Need to abstract video source/decoder to a "singleton" 
				[DONE] - Once source/decoder for that file per program
			[DONE] - When slide*Group* is set on scene, need to scan and initalize decoders for all videos, but STOP at first frame
			[DONE] - When cross fade starts, start playing
			[DONE] - Stop playing prev slide when cross fade ends
			[DONE] - Dont Release provider unless slide group is taken off scene?
		[DONE] - Shadows (Text):
			[DONE] - Can settle for simple block shadow
			[LATER] - Gausian blur if we have time 
		[DONE] - Backgrounds:
			[DONE] - Add background item type & Position automatically, Disable movement
			[DONE] - Still cant set item color/props with config box
		[DONE] - Undo/redo framework
			- Must have this for sermons and announcment slides
			- Property change undo/redo is supported
			- Now must implement undo/redo for:
				- add/remove slides
				- add/remove items on slides
		[DONE] - Snap to grid support
		[LATER] - Gradients - can settle for making gradients in gimp and import as photo, but need to eventually have support direclty in dviz
		[*] - Increse/decrease size of font from toolbar - needed for sermon/announcment
			- see code in textboxcontent.cpp for cursor usage
		- Copy/paste or duplicate slides
		- Layout asissts - center objects vert/horz
			- need hint for this (e.g. songs) to auto adjust - maybe?
		- Image Item
			- Should be easy
			- If we have time, add crop handles
		- SVG Item if we have time
	
	- Improvements:

		[STARTED] Auto-change slides/slide groups after X seconds
				added field in Slide.h, now to make SlideGroupViewer and UI honor the field (and SlideGroup::autoChangeGroup() flag in MainWindow)
		[STARTED] When searching for song, auto select first result
				setCurrentIndex() doesnt seem to be working
		Integrated grid dialog into slideeditor window
		Change SlideEditor in SlideGroupFactory.h to inherit from QMainWindow, then change songeeditor to just set a central widget
		Need to add keyboard nudging/movement of items
			implement AbstractContent::keypressevent
		Need song new/edit/delete functionality
		right-click on slide list in editor to open slide config (incl'd bg config tab or btn to config bg)
			props like time to automatically switch slides, etc
		f2 on selected item to open prop dialog
		Auto-sizing song text should be an option that can be enabled/disabled
			if not autosize, pull size from template / textobx
		option of font family should be available for song
			should it pull from textbox?
		Add rounded rectangle item / or round boxcontent corners
		When searching for song and shift+enter, add song and  GO LIVE
			shift+enter will take a bit of work - would have to subclass QLineEdit and override keypressevent
			
		Need to have a reset template button
		Need to add drag-drop from song list to song group
		Add outputview objects to encapsulate slidegroupviewer or network client/server
		Crop handles should be easy - as move left in, move X out. Basically keep the image rect the same (or add negative offsets)
		On first start, intelligently detect aspect ratio of primary output - if no primary out, create small custom rect in top right
		Global cache pixmaps of doc/slide lists 
		Consider moving opengl option to a per-output setting
		Consider making Output objects QObjects that can emit signals when changed
		Save song templates/bg in a "template collection"
		Add drag/drop background for songs from a yet-to-be-made vid/image bg pallette
		
		[DONE] When searching for song and press enter in text field, auto-add first song to list, 
		[DONE] Need to add form to config snap to grid
		[DONE] Need to integrate appsettings::thirdguidenabled to mygraphicscene
		[DONE] Test NOT specialcasing filltype now that we've added the Q_ENUMS macro
		[DONE] Group together add item commands in an undo group
				Moved the slide->addItem() call in MyGraphicsScene to after the basic name/id prop sets
		[DONE] Need to implement song editor
		[DONE] Look at setting char format thru cursor and using text document to render
		[DONE] In video content/bg: dont reject image if m_still is set UNLESS also has m_size>0 already
		[REJECTED] Need to change double click on song list to send straight to live
		[REJECTED] Add editing to slide group/slide model lists in the list itself (e.g. to change slide/group title)
		[LATER] Audio with videos
				Update QVideo to use QAudioOutput in qtmultimedia tree to play audio in video files
		[LATER] Per-verse custom slides - key to header OR passage#
		[LATER] Master overlay - add "disable master overlay" to slide group option box
		[LATER] Script plugin item
		[LATER] In-flight edits
				need to add specific framework for this
				this could be done by cloning the slidegroup when set on the Live slidegroupviewer
				then when the slide is edited, press "F5" or whatever to send to viewer again
				however, the reason to have a "special key" to update viewer instead of live update (like PPT) in my mind was mainly for text items - so people dont see each keystroke on live output. 
				However, since text is edited in editor dialog THEN updated as a visually atomic transaction, a live-link between the editor is okay.
				However, remote dviz viewers will have to hook into the slideeditor window's closed() signal to send an updated slide group to the remote viewer OR listen for changes to props and send those changes over the wire
		[LATER] Crossfading slides with identical content seems to "dim" just slightly for a moment
				caused by fact that each items opacity fades individually on the scene so the bg "shows thru" the text until fully opaqe while crossfading
				possible fix: seperate fade roots for background content vs non-background content
				putting off for now inorder to get this release out the door
				this is more an asthetic preference right now - and an important one, but not a showstopper. More of an improvment I guess.
		
	- Bugs:
		Rotating a boxcontent causes very wierd pen width scaling issues in previews
		Text editor in slide still white sometimes
		Need better method of managing song regexps - right now the filters exist in the pixmap generation routines, the editor window, and the slide group!!
		On windows, when setting video item live, it doesnt play unless you dbl-click the slide again
		Win32: If blank document "<document/>", crash when add group then click group
		Win32: File->New crashes
				probably fixed, need to verify 
				Nope! Still need work.
				Crashes even with non-live items
				Confirmed that it "new" works on linux tho - need to debug on windows then - drats
		Perfomance of the document pixmap model generator becomes a problem with a lot of songs - need to investigate - possibly use different cache key
		
		[FIXED] Backgrounds in per-verse slides dont work consistently (sometimes override, sometimes master shows thru)
				I think its because both BackgroundContent items (from master and child) are added to final slide 
				need to remove master bg if one in child
				could not preproduce on linux, but I applied the assumed fix anyway - remove master bg if child slide has a bg
		[FIXED] Visual item's QColor toxml routines dont save alpha channel!
				modified routines in AbstractVisualItem to save qcolor as a explicit csv-list of rgba values instead of a uint-cast .rgba() value
		[FIXED] Undo/redo of shadow enabled on text box doesn't seem to work
				typo of the property name - fixed the Q_PROPERTY's property name and its all good now
		[FIXED] F2 with no slidegroup selected in main screen - segfault
				Checked idx.isValid() in actionEditGroup() and actionDelGroup()
		[FIXED] Add slide, add box, delete slide, undo delete slide, move box - segfault
				not sure exactly what fixed it - I really dont. Somewhere in the last 2 svn revs it was fixed.
		[FIXED] Adding an item to an slide that was removed then readded causes segfault
				not sure exactly what fixed it - I really dont. Somewhere in the last 2 svn revs it was fixed.
		[FIXED] Undoing "del slide" causes segfault (e.g. trying to re-add slide using undo after deleing the slide)
				slideeditorwindow was doing 'delete slide' at end of the slot that removed the slide
				moved the delete slide to the destructor of UndoSlideRemoved action
		[FIXED] Undo "add slide" removes the wrong slide!
				logic error - I gave the wrong slide to the UndoSlideAdded action
		[FIXED] Undo item add never removes the item (goes back to add item, just doesnt remove it)
				for some reason, we have to call m_window->scene()->removeVisualDelegate() explicitly in the UndoSlideItemAdded::undo() handler
		[FIXED] Undo of item removal doesn't work corectly
				undo item removal works now - just swapped method calls around in the command
		[FIXED] Undo/redo of change fill type doesn't work - probably need to cast to/from int
				had to special-case the fillType field in the UndoSlideItemChanged command
				seems QObject::setProperty() never called the property writer for fillType, my guess is because fillType is a custom enum
				Fixed: had to call Q_ENUMS(FillType) after the Q_PROPERTY declerations - now I don't need to special case filltype - yay!
		[FIXED] "Lower" btn in config doesnt propegate to live view
				due to not syncing to model in the qgraphicsitem propchanged event, zvalue wasnt being sent to model
				changed MyGraphicsScene (which handles the z value changing) to update content->modelItem(), which would then propogate to the visual
		[FIXED] Need to ignore height of song textbox in template
				Fixed underlying problem - Compensated by enlarging textbox if needed, but not shrinking textbox
		[FIXED] Editing text doesnt update slide editor slide until close editor and reopen
				had to delete cached rendered text pixmap (delete m_text and update graphics, regenerating cached pixmap)
		[FIXED] In SongGroup, define "first textbox" by z value - current def is too arbitrary (relies on order of items added)
		[FIXED] In item config dialog, video "play" button does nothing - hide for later revs
		[FIXED] Starting new results in incorrect AR for "new" doc - doc should adopt current live AR
				Added liveAspectRatio method to app settings and routines to search outputs by tag
		[FIXED] When starting with no document (test.xml), closing program results in "cannot write to ''" (should prompt to save as)
				Do saveFile in closeEvent, check for empty filename, prompt saveas, if cancel saveas, then dont accept close event
		[FIXED] File->New with item on live output item crashes dviz
				the releasegroup method caused currentChanged signal, which caused the view control to try to change slides while group was being released
				just added bool lock flag so when releasegroup was called, the signal that listened for currentchanged would ignore signals
		[FIXED] Document list icons need to be lot smaller
				Changed initial icon size in DocumentListModel from 192 to 48
		[FIXED] Shadow option has no effect on box object - either remove tab or enable shaodw
				enabled basic shadow rendering - no gausian blur yet
		[FIXED] Turning on/off line has no effect on box 
		[FIXED] Turning on/off bg has no effect on box
				made BoxContent honor fillEnabled/outlineEnabled flags
		[FIXED] Changing AR doesn't resize background elements of slides in document - probably should automatically
				updated BackGround content to listen for a 'sceneRectChanged()' signal from MyGraphicsScene
		[FIXED] text config box text is white - maybe need to get html from model item for editing??
				adjusted textconfig dialog to load/save text to model and rely on sync signals to load text to visual delegate
		[FIXED] Song cross fade / go live performance is terrible
				converted text layout to use Qt's QTextDocument after learning how to set text output pen
		[HACK-FIX] Slide editor -> new slide doesnt show slide in list model again!
				hacked by doing a calling m_editWin->setSlideGroup(group); before AND after showing the edit window - doesnt seem right, but it works
		[FIXED] When go live, auto select the current live slide
				simple code change to set currentIndex
		[WORKSFORME] Slide in icon preview for slide group isnt always the first slide
				not sure where I saw this, but can't repeat
		[FIXED] When changing output size with custom output, output disappers until program restart
				simply called setVisible on outputs after closing the output dialog
		[FIXED] When using 1.6AR, content locations centered in slide editor appear off center in preview and live (but correct in icons)
				it was actually the slideditor window that was wrong (and the live view) because both were created before the document was loaded
		[FIXED] Somtimes going live with video item it doesnt play
				had to do with QVideoProvider's internal play/pause counter
		[FIXED] When setting video in slide editor, it never shows first frame
				had to do with QVideoProvider's internal play/pause counter
		[FIXED] Video slides crashing when made live on Win32
		[FIXED] When changing AR, reload document (or recreate slides)
		[FIXED] Songs need to be vertically centered as well
		[FIXED] Cross fading text with shadows shows ugly "dark" text during crossfade - need to investigate clipping shadow to only visible part of painter path
		[FIXED] When dbl click on a FILTERED song list, the song clicked comes from the UNFILTERED list (e.g. its not the song clicked)
		[FIXED] Major problems with song list display
		[FIXED] Song Text not being layed out properly with the "center" functionality (text being clipped, etc) - Can't use <br> tags I fond out.
		[HACK-FIX] Song slide preview has lines that are "too thick"
		[FIXED] Song text on output is too far to the top-left (but preview is fine) - aspect ratio was set wrong and had to adjustViewScaling when chaged
		[FIXED] Need to set item name in slide generator for songs
		[FIXED] Need to set item id in slide generator
		[FIXED] Songs aren't being converted toXml properly (is toXml virtual??)
				needed to match the function signatures exactly - in this case, toXml was missing the 'const' from the original defn
		[FIXED] When another slide live first, then trans to video slide, single click (preview) different slide, the live item stops playing
		[FIXED] Centered TextBox items appear too far to the left in icon previews (list models, etc)
		[FIXED] Setting config on background item causes it to "go away" until program reload
		[FIXED] Output Dialog should have all tabs on left disabled until output selected, otherwise SIGSEGV if user clicks screen list before selecting output
		[FIXED] new slide button stopped working
		[WORKSFORME] slide editor crash when add box then delete box
		[FIXED] slide listbox cant scroll down below the fold
		[WORKSFORME] figure out why some items (VideoFileContent for now) jumps position vertically when slide changes
		[FIXED] figure out why mirror item doesnt get repainted when slide changed back
		[FIXED] turn off multi-select unless intentional - looks like if one item selected, then right-click on another item, it selects both items
		[FIXED] repaint bug -see textitem - when textobx selected and hover over other content, bg in text box turns white...why?
		[FIXED] (r86) -since textbox clipping has been turned on, need to keep all text inside content rect - add margin or something to layout - see letter "L" in tahoma at start of a box


513-584-1000
neural intesive care unit


Release 0.1b
----
	Specs:
	------
		x Basic Editor with support for:
			x Slides
				Basic Timeline
				x Visual Items
					# Video Files
					Pictures
					# Text
			x Slide Groups
				Basic SG Timeline
		# Internal Slide Model
		# Basic Stringification Support
		# Save/Load Support
		x  Basic Viewer
			# Load Slide Groups 
			Execute Timeline and Slides
			Listen for Re-Publish Event from Editor
			
		x Main Components:
			x Slide Group Editor
			# Playlist Selector
			# Preview Pane
			Live Control Pane
			x Viewer Window
		
	Milestones:
	-----------
	
		Milestone A - Target 10:30pm 2009-09-06
		----
			# Port FotoWall AbstractContent Items
			# Create Editor Canvas Framework
			# Editor Canvas
				# Resizable Items
				# Properties Window
			
		Milestone B - Target 10:30pm 2009-09-07
		----
			# Slide Model / Item Model
			# Slide Group Model
			# Load/Save Framework for slides, items, slide groups, slide templates
			# Adapt abastractconfig to top-level widget
			
		Milestone C - Target 10:30pm 2009-09-08
		----
			# Code to translate model to GraphicsView
			# Slide Template Model 
			# Revert to old CornerItems
			# Create TextBox Item 
			# Basic Editor (toolbar with items, click, add to canvas)
			# Basic Viewer for Model
			*** Editor Publish Update
			
		Milestone D - Target 10:30pm 2009-09-10
		---
			# Slide Group
			*** Timeline Widget
			*** Transitions
		
		Milestone E - Target 10:30pm 2009-09-13
		---
			Prep for Release 0.1b
			Documentation
			Test Cases
			Sample Data
			Performance Tests

Release 0.2 - Target 2009-09-16
---
	Slide Group Visual Elements
	# Playlist Model
	Viewer Control Panel
	Effects for Text and Photos
	
Relase 0.3 - Target 2009-09-23
---
	Timeline Enhancements
		- Cursor Control Items
			(jump/loop/pause/wait/sync to other)
		- Send Sync Signal
	Non Visual Items
		Basic Script Element
		System Exec
		Basic Audio Support
		Timeline Control Element
		
Release 0.4 - Target 2009-09-30
---
	* Multiple Outputs
	Slide "Filter" for say, rear, output
	Output selection/control UI
		sync to main / custom Slide Group
	# Preview windows for each output dockable

Release 0.5 - Target 2009-10-14
---
	Networkable Viewer (control from main or control on remote, sync to main)
	Audio in Videos
	Network Video Feeds
	Network Feed from Remote DViz 
	Live Video Camera Item
	
Release 0.6 - Target 2009-10-21
---
	Visual Polish
		Transitions (3d/2d)
		Image/Element Effects

Release 0.7 - Target 2009-11-04
---
	DViz Control Enhancments
		Songs Support
			- may need to move up in schedule
		Bible Support
		News Ticker
		Blank/Clear Buttons
			- should be fairly easy to do blank
			- clear requires more abstraction of items
		Date/Time Item
		Video Folders
		Image Folders

Release 0.8 - Target 2009-11-18
---
	Remote Control API
	Remote Control Web Page for Smart Phones
	Touch Screen Interface for Song Leader Control
	Keypad Clicker Support for Stage Remotes
	
Release 0.9 - Target 2009-11-25
---
	DViz Control View Rework and Polish
	Bug Testing
	Extensive Documentation
	Preview Release Online
	
Release 1.0 - Target 2009-12-09
---
	Public Release
	$99 for Basic (Simple Editor/Playlist/Viewer/Multi Outputs)
	$199 for Profesional (Network Viewer/Multiple Viewers Sync over Network/Stream over Network/Song Leader Control UI)
	
----------------------------------------------------
Future Release Feature Sets contingent upon feedback
----------------------------------------------------

